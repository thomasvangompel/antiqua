{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <h2>{{ seller.business_name or seller.username }}</h2>

  <div class="row mb-4">
    <div class="col-md-3">
      <img src="{{ url_for('static', filename='profile_pics/' + seller.image_file) }}"
           alt="Profielfoto"
           class="img-fluid rounded"
           onerror="this.style.display='none'">
    </div>
    <div class="col-md-9">
      <p><strong>Locatie:</strong> {{ seller.city or 'Onbekend' }}</p>
      {% if not (current_user.is_authenticated and current_user.id == seller.id) %}
        <a href="{{ url_for('main.contact_seller', business_name=seller.business_name) }}" 
           class="btn btn-success mt-3 mt-md-0">
          Stuur bericht naar verkoper
        </a>
      {% endif %}
      
    </div>
  </div>


 
<hr>

  <h4 class="mt-4">Alle boeken van deze verkoper</h4>
  {% if books %}
    <div class="row">
      {% for book in books %}
        <div class="col-md-4 mb-4">
          <div class="card h-100 card-verkoper">
            {% if book.front_image %}
              <img src="{{ url_for('static', filename='uploads/' ~ book.front_image) }}"
                   alt="Voorkant van {{ book.title }}"
                   class="card-img-top">
            {% endif %}
            <div class="card-body">
              <h5 class="card-title">{{ book.title }}</h5>
              <p class="card-text"><strong>Auteur:</strong> {{ book.author }}</p>

              {% if book.is_auction %}
                <p class="card-text text-success">
                  <strong>Hoogste bod:</strong>
                  {% if highest_bids[book.id] %}
                    €{{ "%.2f"|format(highest_bids[book.id]) }}
                  {% else %}
                    Geen biedingen
                  {% endif %}
                </p>
              {% else %}
                <p class="card-text"><strong>Prijs:</strong>
                  {% if book.price is not none %}
                    €{{ "%.2f"|format(book.price) }}
                  {% else %}
                    Niet beschikbaar
                  {% endif %}
                </p>
              {% endif %}

              <a href="{{ url_for('main.book_detail', book_id=book.id) }}"
                 class="btn btn-primary">
                Bekijk boek
              </a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>Deze verkoper heeft momenteel geen boeken te koop.</p>
  {% endif %}

</div>

<hr>
 {% if reviews %}
    <ul class="list-group mb-4">
      {% for review in reviews %}
        <li class="list-group-item">
          <strong>{{ review.author_name }}:</strong> {{ review.content }}
          <br>
          <small class="text-muted">{{ review.date_posted.strftime('%d-%m-%Y') }}</small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Er zijn nog geen reviews.</p>
  {% endif %}
{% endblock %}
